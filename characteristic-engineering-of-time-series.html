<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="keywords" content="Hexo Theme Keep"><meta name="description" content="fighting"><meta name="author" content="EasyBoy"><title>æ—¶é—´åºåˆ—ç‰¹å¾å·¥ç¨‹ | EasyBoy</title><link rel="stylesheet" href="/css/style.css"><link rel="shortcut icon" href="/images/cell-16x16-next.png"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/css/font-awesome.min.css"><script id="hexo-configurations">let KEEP=window.KEEP||{};KEEP.hexo_config={hostname:"easyboy-blog.com",root:"/",language:"zh-CN",path:"search.xml"},KEEP.theme_config={toc:{enable:!0,number:!1,expand_all:!0,init_open:!0},style:{primary_color:"#0066CC",avatar:"/images/avatar.jpeg",favicon:"/images/cell-16x16-next.png",article_img_align:"left",left_side_width:"260px",content_max_width:"920px",hover:{shadow:!1,scale:!1},first_screen:{enable:!0,background_img:"https://cdn.staticaly.com/gh/fight-ing-go/image_repository@master/wallpaper_img/wallhaven-8omxly_3840x2160.2jbfmfsgxcy0.jpg",description:"Welcome to Easyboy's Blog"},scroll:{progress_bar:{enable:!1},percent:{enable:!1}}},local_search:{enable:!0,preload:!0},code_copy:{enable:!0,style:"default"},pjax:{enable:!0},lazyload:{enable:!0},version:"3.4.5"},KEEP.language_ago={second:"%s ç§’å‰",minute:"%s åˆ†é’Ÿå‰",hour:"%s å°æ—¶å‰",day:"%s å¤©å‰",week:"%s å‘¨å‰",month:"%s ä¸ªæœˆå‰",year:"%s å¹´å‰"}</script><meta name="generator" content="Hexo 6.0.0"><style>.github-emoji{position:relative;display:inline-block;width:1.2em;min-height:1.2em;overflow:hidden;vertical-align:top;color:transparent}.github-emoji>span{position:relative;z-index:10}.github-emoji .fancybox,.github-emoji img{margin:0!important;padding:0!important;border:none!important;outline:0!important;text-decoration:none!important;user-select:none!important;cursor:auto!important}.github-emoji img{height:1.2em!important;width:1.2em!important;position:absolute!important;left:50%!important;top:50%!important;transform:translate(-50%,-50%)!important;user-select:none!important;cursor:auto!important}.github-emoji-fallback{color:inherit}.github-emoji-fallback img{opacity:0!important}</style><link rel="alternate" href="/atom.xml" title="home-laser" type="application/atom+xml">
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head><body><div class="progress-bar-container"><span class="pjax-progress-bar"></span> <span class="pjax-progress-icon"><i class="fas fa-circle-notch fa-spin"></i></span></div><main class="page-container"><div class="page-main-content"><div class="page-main-content-top"><header class="header-wrapper"><div class="header-content"><div class="left"><a class="logo-image" href="/"><img src="/images/cell-32x32-next.png"> </a><a class="logo-title" href="/">EasyBoy</a></div><div class="right"><div class="pc"><ul class="menu-list"><li class="menu-item"><a href="/">é¦–é¡µ</a></li><li class="menu-item"><a href="/archives">å½’æ¡£</a></li><li class="menu-item"><a href="/categories">åˆ†ç±»</a></li><li class="menu-item"><a href="/tags">æ ‡ç­¾</a></li><li class="menu-item"><a href="/about">å…³äº</a></li><li class="menu-item search search-popup-trigger"><i class="fas fa-search"></i></li></ul></div><div class="mobile"><div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div><div class="icon-item menu-bar"><div class="menu-bar-middle"></div></div></div></div></div><div class="header-drawer"><ul class="drawer-menu-list"><li class="drawer-menu-item flex-center"><a href="/">é¦–é¡µ</a></li><li class="drawer-menu-item flex-center"><a href="/archives">å½’æ¡£</a></li><li class="drawer-menu-item flex-center"><a href="/categories">åˆ†ç±»</a></li><li class="drawer-menu-item flex-center"><a href="/tags">æ ‡ç­¾</a></li><li class="drawer-menu-item flex-center"><a href="/about">å…³äº</a></li></ul></div><div class="window-mask"></div></header></div><div class="page-main-content-middle"><div class="main-content"><div class="fade-in-down-animation"><div class="article-content-container"><div class="article-title"><span class="title-hover-animation">æ—¶é—´åºåˆ—ç‰¹å¾å·¥ç¨‹</span></div><div class="article-header"><div class="avatar"><img src="/images/avatar.jpeg"></div><div class="info"><div class="author"><span class="name">EasyBoy</span></div><div class="meta-info"><div class="article-meta-info"><span class="article-date article-meta-item"><i class="fas fa-edit"></i>&nbsp; <span class="pc">2022-04-23 14:50:40</span> <span class="mobile">2022-04-23 14:50</span><span class="pc">æ›´æ–°äºï¼š2022-04-23</span> </span><span class="article-categories article-meta-item"><i class="fas fa-folder"></i>&nbsp;<ul><li><a href="/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">æœºå™¨å­¦ä¹ </a>&nbsp;</li></ul></span><span class="article-tags article-meta-item"><i class="fas fa-tags"></i>&nbsp;<ul><li><a href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">æœºå™¨å­¦ä¹ </a>&nbsp;</li><li>| <a href="/tags/%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97/">æ—¶é—´åºåˆ—</a>&nbsp;</li><li>| <a href="/tags/%E7%89%B9%E5%BE%81%E5%B7%A5%E7%A8%8B/">ç‰¹å¾å·¥ç¨‹</a>&nbsp;</li></ul></span><span class="article-wordcount article-meta-item"><i class="fas fa-file-word"></i>&nbsp;<span>2.4k å­—</span> </span><span class="article-pv article-meta-item"><i class="fas fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span></span></div></div></div></div><div class="article-content markdown-body"><p>å®Œæˆæ•°æ®æ¸…æ´—ä¹‹åï¼Œéœ€è¦æå–æœ‰æ„ä¹‰çš„æ ·æœ¬ç‰¹å¾è¾“å…¥æ¨¡å‹ä¸­è®­ç»ƒï¼Œç›®çš„æ˜¯ä¸ºäº†æ›´é«˜æ•ˆçš„åˆ©ç”¨ç®—æ³•ã€‚æå–ç‰¹å¾çš„æ­¥éª¤å«ç‰¹å¾å·¥ç¨‹ï¼Œåˆ†ä¸ºä¸‰æ­¥ï¼šç‰¹å¾æå–ã€ç‰¹å¾é¢„å¤„ç†ã€ç‰¹å¾é™ç»´ã€‚ä¸‹é¢å°†é’ˆå¯¹æ—¶åºåºåˆ—çš„ç‰¹å¾å·¥ç¨‹è¿›è¡Œè®²è¿°ã€‚</p><span id="more"></span><h1 id="1-ç‰¹å¾æå–"><a href="#1-ç‰¹å¾æå–" class="headerlink" title="1. ç‰¹å¾æå–"></a>1. ç‰¹å¾æå–</h1><p>æå–æ—¶é—´åºåˆ—çš„ç‰¹å¾å¯ä»¥ä»ä¸‰æ–¹é¢ç€æ‰‹ã€‚</p><h2 id="1-1-ä»æ—¶é—´ä¸­æå–ç‰¹å¾"><a href="#1-1-ä»æ—¶é—´ä¸­æå–ç‰¹å¾" class="headerlink" title="1.1 ä»æ—¶é—´ä¸­æå–ç‰¹å¾"></a>1.1 ä»æ—¶é—´ä¸­æå–ç‰¹å¾</h2><p>æ¯æ¡æ ·æœ¬æ•°æ®å¯¹åº”çš„æ—¶é—´æ•°æ®åŒ…å«å¾ˆå¤šä¿¡æ¯ï¼Œå¯ä»¥ä»ä¸­å‘ç°æ—¶é—´ä¸Šçš„ä¸€äº›è§„å¾‹ç‰¹å¾ã€‚<br>æå–æ—¶é—´ç‰¹å¾å¯ä»¥å¯¹æ—¶é—´è¿›è¡Œæ‹†è§£ï¼Œå¦‚2022.04.23 15:08:03ï¼Œå¯ä»¥å°†å…¶ä¸­å¹´æœˆæ—¥æ—¶åˆ†ç§’åˆ†åˆ«æ‹†è§£ä¸ºä¸€åˆ—ï¼Œæˆ–è€…ä»¥æŸä¸ªæ—¶é—´ç‚¹ä¸ºèµ·ç‚¹ï¼Œè®¡ç®—ç»è¿‡çš„æ—¶é—´ï¼Œå¦‚ä¸€å¤©ä¸­çš„ç¬¬å‡ åˆ†é’Ÿï¼Œä¸€å¹´ä¸­çš„ç¬¬å‡ å¤©æˆ–ç¬¬å‡ å‘¨ç­‰ç­‰ã€‚å¯¹äºå—å­£èŠ‚ã€èŠ‚å‡æ—¥å½±å“çš„æ•°æ®ï¼Œä¹Ÿå¯ä»¥åˆ¤æ–­æ˜¯å¦æœˆåˆã€æœˆæœ«ã€å‘¨æœ«ã€å…¬å…±å‡æœŸã€è¥ä¸šæ—¶é—´ç­‰ç­‰ã€‚<br><strong>ä¸¾ä¾‹ç¨‹åºå®ç°ï¼š</strong></p><pre class="language-python"><code class="language-python">df <span class="token operator">=</span> Month_data_1T<span class="token punctuation">.</span>iloc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">1</span><span class="token punctuation">]</span>
df<span class="token punctuation">[</span><span class="token string">'æ—¶é—´'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">.</span>index
<span class="token comment" spellcheck="true"># å¹´ä»½</span>
df<span class="token punctuation">[</span><span class="token string">'å¹´'</span><span class="token punctuation">]</span><span class="token operator">=</span>df<span class="token punctuation">[</span><span class="token string">'æ—¶é—´'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>apply<span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">.</span>year<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># æœˆä»½</span>
df<span class="token punctuation">[</span><span class="token string">'æœˆ'</span><span class="token punctuation">]</span><span class="token operator">=</span>df<span class="token punctuation">[</span><span class="token string">'æ—¶é—´'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>apply<span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">.</span>month<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># æ—¥</span>
df<span class="token punctuation">[</span><span class="token string">'æ—¥'</span><span class="token punctuation">]</span><span class="token operator">=</span>df<span class="token punctuation">[</span><span class="token string">'æ—¶é—´'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>apply<span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">.</span>day<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># å°æ—¶</span>
df<span class="token punctuation">[</span><span class="token string">'æ—¶'</span><span class="token punctuation">]</span><span class="token operator">=</span>df<span class="token punctuation">[</span><span class="token string">'æ—¶é—´'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>apply<span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">.</span>hour<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># åˆ†é’Ÿ</span>
df<span class="token punctuation">[</span><span class="token string">'åˆ†'</span><span class="token punctuation">]</span><span class="token operator">=</span>df<span class="token punctuation">[</span><span class="token string">'æ—¶é—´'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>apply<span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">.</span>minute<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># ä¸€å¤©ä¸­çš„ç¬¬å‡ åˆ†é’Ÿ</span>
df<span class="token punctuation">[</span><span class="token string">'ä¸€å¤©ä¸­çš„ç¬¬å‡ åˆ†é’Ÿ'</span><span class="token punctuation">]</span><span class="token operator">=</span>df<span class="token punctuation">[</span><span class="token string">'æ—¶é—´'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>apply<span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">.</span>minute <span class="token operator">+</span> x<span class="token punctuation">.</span>hour<span class="token operator">*</span><span class="token number">60</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># æ˜ŸæœŸå‡ ï¼›</span>
df<span class="token punctuation">[</span><span class="token string">'æ˜ŸæœŸå‡ '</span><span class="token punctuation">]</span><span class="token operator">=</span>df<span class="token punctuation">[</span><span class="token string">'æ—¶é—´'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>apply<span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">.</span>dayofweek<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># ä¸€å¹´ä¸­çš„ç¬¬å‡ å¤©</span>
df<span class="token punctuation">[</span><span class="token string">'ä¸€å¹´ä¸­çš„ç¬¬å‡ å¤©'</span><span class="token punctuation">]</span><span class="token operator">=</span>df<span class="token punctuation">[</span><span class="token string">'æ—¶é—´'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>apply<span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">.</span>dayofyear<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># # ä¸€å¹´ä¸­çš„ç¬¬å‡ å‘¨</span>
<span class="token comment" spellcheck="true"># df['ä¸€å¹´ä¸­çš„ç¬¬å‡ å‘¨']=df['æ—¶é—´'].apply(lambda x: x.week)</span>
<span class="token comment" spellcheck="true"># ä¸€å¤©ä¸­å“ªä¸ªæ—¶é—´æ®µï¼šå‡Œæ™¨ã€æ—©æ™¨ã€ä¸Šåˆã€ä¸­åˆã€ä¸‹åˆã€å‚æ™šã€æ™šä¸Šã€æ·±å¤œï¼›</span>
period_dict <span class="token operator">=</span><span class="token punctuation">{</span>
    <span class="token number">23</span><span class="token punctuation">:</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">:</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">:</span> <span class="token number">0x00</span><span class="token punctuation">,</span>
    <span class="token number">2</span><span class="token punctuation">:</span> <span class="token number">0x01</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">:</span> <span class="token number">0x01</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">:</span> <span class="token number">0x01</span><span class="token punctuation">,</span>
    <span class="token number">5</span><span class="token punctuation">:</span> <span class="token number">0x02</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">:</span> <span class="token number">0x02</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">:</span> <span class="token number">0x02</span><span class="token punctuation">,</span>
    <span class="token number">8</span><span class="token punctuation">:</span> <span class="token number">0x03</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">:</span> <span class="token number">0x03</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">:</span> <span class="token number">0x03</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">:</span> <span class="token number">0x03</span><span class="token punctuation">,</span>
    <span class="token number">12</span><span class="token punctuation">:</span> <span class="token number">0x04</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">:</span> <span class="token number">0x04</span><span class="token punctuation">,</span><span class="token number">14</span><span class="token punctuation">:</span> <span class="token number">0x04</span><span class="token punctuation">,</span> 
    <span class="token number">15</span><span class="token punctuation">:</span> <span class="token number">0x05</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">:</span> <span class="token number">0x05</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">:</span> <span class="token number">0x05</span><span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">:</span> <span class="token number">0x05</span><span class="token punctuation">,</span>
    <span class="token number">19</span><span class="token punctuation">:</span> <span class="token number">0x07</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">:</span> <span class="token number">0x07</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">:</span> <span class="token number">0x07</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">:</span> <span class="token number">0x07</span><span class="token punctuation">,</span>
<span class="token comment" spellcheck="true">#     23: 'æ·±å¤œ', 0: 'æ·±å¤œ', 1: 'æ·±å¤œ',</span>
<span class="token comment" spellcheck="true">#     2: 'å‡Œæ™¨', 3: 'å‡Œæ™¨', 4: 'å‡Œæ™¨',</span>
<span class="token comment" spellcheck="true">#     5: 'æ—©æ™¨', 6: 'æ—©æ™¨', 7: 'æ—©æ™¨',</span>
<span class="token comment" spellcheck="true">#     8: 'ä¸Šåˆ', 9: 'ä¸Šåˆ', 10: 'ä¸Šåˆ', 11: 'ä¸Šåˆ',</span>
<span class="token comment" spellcheck="true">#     12: 'ä¸­åˆ', 13: 'ä¸­åˆ',14: 'ä¸­åˆ',</span>
<span class="token comment" spellcheck="true">#     15: 'ä¸‹åˆ', 16: 'ä¸‹åˆ', 17: 'ä¸‹åˆ',18: 'ä¸‹åˆ',</span>
<span class="token comment" spellcheck="true">#     19: 'æ™šä¸Š', 20: 'æ™šä¸Š', 21: 'æ™šä¸Š', 22: 'æ™šä¸Š',</span>
<span class="token punctuation">}</span>
df<span class="token punctuation">[</span><span class="token string">'æ—¶é—´æ®µ'</span><span class="token punctuation">]</span><span class="token operator">=</span>df<span class="token punctuation">[</span><span class="token string">'æ—¶'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>map<span class="token punctuation">(</span>period_dict<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># # ä¸€å¹´ä¸­çš„å“ªä¸ªå­£åº¦</span>
<span class="token comment" spellcheck="true"># season_dict = {</span>
<span class="token comment" spellcheck="true">#     1: 'æ˜¥å­£', 2: 'æ˜¥å­£', 3: 'æ˜¥å­£',</span>
<span class="token comment" spellcheck="true">#     4: 'å¤å­£', 5: 'å¤å­£', 6: 'å¤å­£',</span>
<span class="token comment" spellcheck="true">#     7: 'ç§‹å­£', 8: 'ç§‹å­£', 9: 'ç§‹å­£',</span>
<span class="token comment" spellcheck="true">#     10: 'å†¬å­£', 11: 'å†¬å­£', 12: 'å†¬å­£',</span>
<span class="token comment" spellcheck="true"># }</span>
<span class="token comment" spellcheck="true"># df['å­£èŠ‚']=df['æœˆ'].map(season_dict)</span>
<span class="token comment" spellcheck="true"># # æ˜¯å¦é—°å¹´</span>
<span class="token comment" spellcheck="true"># df['æ˜¯å¦é—°å¹´'] = df['æ—¶é—´'].apply(lambda x: x.is_leap_year)</span>
<span class="token comment" spellcheck="true"># æ˜¯å¦æœˆåˆ</span>
df<span class="token punctuation">[</span><span class="token string">'æ˜¯å¦æœˆåˆ'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'æ—¶é—´'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>apply<span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">.</span>is_month_start<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># æ˜¯å¦æœˆæœ«</span>
df<span class="token punctuation">[</span><span class="token string">'æ˜¯å¦æœˆæœ«'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'æ—¶é—´'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>apply<span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">.</span>is_month_end<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># æ˜¯å¦å­£èŠ‚åˆ</span>
<span class="token comment" spellcheck="true"># df['æ˜¯å¦å­£èŠ‚åˆ'] = df['æ—¶é—´'].apply(lambda x: x.is_quarter_start)</span>
<span class="token comment" spellcheck="true"># æ˜¯å¦å­£èŠ‚æœ«</span>
<span class="token comment" spellcheck="true"># df['æ˜¯å¦å­£èŠ‚æœ«'] = df['æ—¶é—´'].apply(lambda x: x.is_quarter_end)</span>
<span class="token comment" spellcheck="true"># æ˜¯å¦å¹´åˆ</span>
<span class="token comment" spellcheck="true"># df['æ˜¯å¦å¹´åˆ'] = df['æ—¶é—´'].apply(lambda x: x.is_year_start)</span>
<span class="token comment" spellcheck="true"># æ˜¯å¦å¹´å°¾</span>
<span class="token comment" spellcheck="true"># df['æ˜¯å¦å¹´å°¾'] = df['æ—¶é—´'].apply(lambda x: x.is_year_end)</span>
<span class="token comment" spellcheck="true"># æ˜¯å¦å‘¨æœ«</span>
df<span class="token punctuation">[</span><span class="token string">'æ˜¯å¦å‘¨æœ«'</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'æ—¶é—´'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>apply<span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token boolean">True</span> <span class="token keyword">if</span> x<span class="token punctuation">.</span>dayofweek <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span> <span class="token keyword">else</span> <span class="token boolean">False</span><span class="token punctuation">)</span>
df
</code></pre><p>ç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><div align="center"><img src="https://cdn.jsdelivr.net/gh/fight-ing-go/image_repository@master/202204/Characteristic-Engineering-of-Time-Series/æ—¶é—´ç‰¹å¾.407xag8uznw0.jpg"></div><h2 id="1-2-ä»æ—¶åºè§„å¾‹ä¸­æå–ç‰¹å¾"><a href="#1-2-ä»æ—¶åºè§„å¾‹ä¸­æå–ç‰¹å¾" class="headerlink" title="1.2 ä»æ—¶åºè§„å¾‹ä¸­æå–ç‰¹å¾"></a>1.2 ä»æ—¶åºè§„å¾‹ä¸­æå–ç‰¹å¾</h2><p>åœ¨æ•°æ®æ¸…æ´—åçš„æ•°æ®åˆ†æä¸­ï¼Œé€šå¸¸ä¼šåˆ†ææ—¶é—´åºåˆ—çš„ä¸€äº›ç‰¹æ€§ï¼Œå¦‚å‘¨æœŸæ€§ã€æ—¶é—´åºåˆ—åˆ†è§£ã€å†å²æ•°æ®ï¼Œå¯ä»¥æŠŠè¿™äº›åˆ†æå‡ºæ¥çš„æ•°æ®ç”¨ä½œç‰¹å¾ã€‚<br>**ä¸¾ä¾‹ç¨‹åºå®ç°ï¼š **</p><pre class="language-python"><code class="language-python"><span class="token keyword">from</span> statsmodels<span class="token punctuation">.</span>tsa<span class="token punctuation">.</span>seasonal <span class="token keyword">import</span> seasonal_decompose
<span class="token comment" spellcheck="true"># æ•°æ®å«æœ‰ä¸¤ä¸ªå‘¨æœŸ77å’Œ1440</span>
<span class="token comment" spellcheck="true"># åç§»6minå·®åˆ†</span>
df<span class="token punctuation">[</span><span class="token string">"Hu0_-5S"</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'Hu_0'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>shift<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># åç§»77minå·®åˆ†ï¼Œä¸€å°å‘¨æœŸ</span>
df<span class="token punctuation">[</span><span class="token string">"Hu0_-1period"</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'Hu_0'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>shift<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">*</span><span class="token number">77</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># åç§»ä¸¤å°å‘¨æœŸ</span>
df<span class="token punctuation">[</span><span class="token string">"Hu0_-2period"</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'Hu_0'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>shift<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span><span class="token number">77</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># åç§»1å¤©ï¼Œä¸€å¤§å‘¨æœŸ</span>
df<span class="token punctuation">[</span><span class="token string">"Hu0_-1day"</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'Hu_0'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>shift<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">*</span><span class="token number">1440</span><span class="token punctuation">)</span>
decompose_result <span class="token operator">=</span> seasonal_decompose<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'Hu_0'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> model<span class="token operator">=</span><span class="token string">"additive"</span><span class="token punctuation">,</span> period<span class="token operator">=</span><span class="token number">77</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># åˆ†ç¦»77å‘¨æœŸåˆ†ç¦»</span>
df<span class="token punctuation">[</span><span class="token string">"Hu0_77seasonal"</span><span class="token punctuation">]</span> <span class="token operator">=</span> decompose_result<span class="token punctuation">.</span>seasonal
decompose_result <span class="token operator">=</span> seasonal_decompose<span class="token punctuation">(</span>decompose_result<span class="token punctuation">.</span>seasonal<span class="token punctuation">,</span> model<span class="token operator">=</span><span class="token string">"additive"</span><span class="token punctuation">,</span> period<span class="token operator">=</span><span class="token number">1440</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># åˆ†ç¦»1440å‘¨æœŸåˆ†é‡</span>
df<span class="token punctuation">[</span><span class="token string">"Hu0_1440seasonal"</span><span class="token punctuation">]</span> <span class="token operator">=</span> decompose_result<span class="token punctuation">.</span>seasonal
<span class="token comment" spellcheck="true"># è¶‹åŠ¿åˆ†é‡</span>
df<span class="token punctuation">[</span><span class="token string">"Hu0_trend"</span><span class="token punctuation">]</span> <span class="token operator">=</span> decompose_result<span class="token punctuation">.</span>trend
<span class="token comment" spellcheck="true"># æ®‹å·®åˆ†é‡</span>
df<span class="token punctuation">[</span><span class="token string">"Hu0_resid"</span><span class="token punctuation">]</span> <span class="token operator">=</span> decompose_result<span class="token punctuation">.</span>resid
df
</code></pre><p><img lazyload="" src="/images/loading.svg" data-src="https://cdn.jsdelivr.net/gh/fight-ing-go/image_repository@master/202204/Characteristic-Engineering-of-Time-Series/%E6%97%B6%E5%BA%8F%E8%A7%84%E5%BE%8B%E7%89%B9%E5%BE%81.5n1vvk2y3d40.jpg" alt="æ—¶åºè§„å¾‹ç‰¹å¾"></p><h2 id="1-3-ä»ç»Ÿè®¡çª—å£æå–ç‰¹å¾"><a href="#1-3-ä»ç»Ÿè®¡çª—å£æå–ç‰¹å¾" class="headerlink" title="1.3 ä»ç»Ÿè®¡çª—å£æå–ç‰¹å¾"></a>1.3 ä»ç»Ÿè®¡çª—å£æå–ç‰¹å¾</h2><p>è¦æƒ³æå–æ—¶é—´åºåˆ—çš„ç»Ÿè®¡ç‰¹å¾ï¼Œéœ€è¦æŒ‰å›ºå®šæ—¶é—´é•¿åº¦æŠŠä¸€æ¡æ—¶é—´åºåˆ—åˆ’åˆ†ä¸ºnå¤šæ¡å­åºåˆ—ï¼Œç„¶åå¯¹è¿™äº›å­åºåˆ—åˆ†åˆ«æ„é€ ç»Ÿè®¡ç‰¹å¾ã€‚<br>**ä¸¾ä¾‹ç¨‹åºå®ç°ï¼š **</p><pre class="language-python"><code class="language-python"><span class="token comment" spellcheck="true"># sum() å€¼çš„æ€»å’Œ</span>
<span class="token comment" spellcheck="true"># mean() å‡å€¼</span>
<span class="token comment" spellcheck="true"># median() å€¼çš„ç®—æœ¯ä¸­å€¼</span>
<span class="token comment" spellcheck="true"># min() æœ€å°å€¼</span>
<span class="token comment" spellcheck="true"># max() æœ€å¤§</span>
<span class="token comment" spellcheck="true"># std() è´å¡å°”ä¿®æ­£æ ·æœ¬æ ‡å‡†å·®(å‡æ–¹å·®)</span>
<span class="token comment" spellcheck="true"># var() æ— åæ–¹å·®</span>
<span class="token comment" spellcheck="true"># cov() æ— ååæ–¹å·®ï¼ˆäºŒå…ƒï¼‰</span>
<span class="token comment" spellcheck="true"># corr() ç›¸å…³ï¼ˆäºŒè¿›åˆ¶ï¼‰</span>
<span class="token comment" spellcheck="true"># variation_v = std_v/mean_v ç¦»æ•£ç³»æ•°</span>
<span class="token comment" spellcheck="true"># polyfit çº¿æ€§æ‹Ÿåˆï¼Œæ±‚æ–œç‡</span>

<span class="token comment" spellcheck="true">#ä½¿ç”¨rollingæ»šåŠ¨çª—å£ï¼Œçª—å£å¤§å°ä¸º7</span>
roll_data <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'Hu_0'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>rolling<span class="token punctuation">(</span>window<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">)</span>
df<span class="token punctuation">[</span><span class="token string">"Hu0_mean"</span><span class="token punctuation">]</span> <span class="token operator">=</span> roll_data<span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span>
df<span class="token punctuation">[</span><span class="token string">"Hu0_median"</span><span class="token punctuation">]</span> <span class="token operator">=</span> roll_data<span class="token punctuation">.</span>median<span class="token punctuation">(</span><span class="token punctuation">)</span>
df<span class="token punctuation">[</span><span class="token string">"Hu0_min"</span><span class="token punctuation">]</span> <span class="token operator">=</span> roll_data<span class="token punctuation">.</span>min<span class="token punctuation">(</span><span class="token punctuation">)</span>
df<span class="token punctuation">[</span><span class="token string">"Hu0_max"</span><span class="token punctuation">]</span> <span class="token operator">=</span> roll_data<span class="token punctuation">.</span>max<span class="token punctuation">(</span><span class="token punctuation">)</span>
df<span class="token punctuation">[</span><span class="token string">"Hu0_std"</span><span class="token punctuation">]</span> <span class="token operator">=</span> roll_data<span class="token punctuation">.</span>std<span class="token punctuation">(</span><span class="token punctuation">)</span>
df<span class="token punctuation">[</span><span class="token string">"Hu0_var"</span><span class="token punctuation">]</span> <span class="token operator">=</span> roll_data<span class="token punctuation">.</span>var<span class="token punctuation">(</span><span class="token punctuation">)</span>
df<span class="token punctuation">[</span><span class="token string">"Hu0_cov"</span><span class="token punctuation">]</span> <span class="token operator">=</span> roll_data<span class="token punctuation">.</span>cov<span class="token punctuation">(</span><span class="token punctuation">)</span>
df<span class="token punctuation">[</span><span class="token string">"Hu0_corr"</span><span class="token punctuation">]</span> <span class="token operator">=</span> roll_data<span class="token punctuation">.</span>corr<span class="token punctuation">(</span><span class="token punctuation">)</span>
df<span class="token punctuation">[</span><span class="token string">"Hu0_variation"</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">"Hu0_std"</span><span class="token punctuation">]</span><span class="token operator">/</span>df<span class="token punctuation">[</span><span class="token string">"Hu0_mean"</span><span class="token punctuation">]</span>
df<span class="token punctuation">[</span><span class="token string">"Hu0_sum"</span><span class="token punctuation">]</span> <span class="token operator">=</span> roll_data<span class="token punctuation">.</span>sum<span class="token punctuation">(</span><span class="token punctuation">)</span>
df<span class="token punctuation">[</span><span class="token string">"Hu0_sum_diff2"</span><span class="token punctuation">]</span> <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">"Hu0_sum"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>shift<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">-</span>df<span class="token punctuation">[</span><span class="token string">"Hu0_sum"</span><span class="token punctuation">]</span><span class="token punctuation">.</span>shift<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># df["Hu0_autocorr1"] = df["Hu_0"].autocorr(1)</span>
<span class="token comment" spellcheck="true"># df["Hu0_autocorr2"] = df["Hu_0"].autocorr(2)</span>
x <span class="token operator">=</span> range<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span>
z <span class="token operator">=</span> <span class="token keyword">lambda</span> y <span class="token punctuation">:</span> np<span class="token punctuation">.</span>polyfit<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
df<span class="token punctuation">[</span><span class="token string">"Hu0_polyfit"</span><span class="token punctuation">]</span> <span class="token operator">=</span> roll_data<span class="token punctuation">.</span>apply<span class="token punctuation">(</span>z<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true"># ä¸€é˜¶å·®åˆ†çš„å‡æ–¹å·®</span>
roll_data_diff <span class="token operator">=</span> df<span class="token punctuation">[</span><span class="token string">'Hu_0'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>diff<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>rolling<span class="token punctuation">(</span>window<span class="token operator">=</span><span class="token number">7</span><span class="token punctuation">)</span>
df<span class="token punctuation">[</span><span class="token string">"Hu0_diff_std"</span><span class="token punctuation">]</span> <span class="token operator">=</span> roll_data_diff<span class="token punctuation">.</span>std<span class="token punctuation">(</span><span class="token punctuation">)</span>
df
</code></pre><p><img lazyload="" src="/images/loading.svg" data-src="https://cdn.jsdelivr.net/gh/fight-ing-go/image_repository@master/202204/Characteristic-Engineering-of-Time-Series/%E7%BB%9F%E8%AE%A1%E7%89%B9%E5%BE%81.6ahmg2mw8s00.jpg" alt="ç»Ÿè®¡ç‰¹å¾"></p><h1 id="2-ç‰¹å¾é¢„å¤„ç†"><a href="#2-ç‰¹å¾é¢„å¤„ç†" class="headerlink" title="2. ç‰¹å¾é¢„å¤„ç†"></a>2. ç‰¹å¾é¢„å¤„ç†</h1><p>ç‰¹å¾é¢„å¤„ç†æ˜¯å¯¹æå–å‡ºæ¥çš„ç‰¹å¾æ— é‡çº²åŒ–ï¼Œç›®çš„æ˜¯è®©ç‰¹å¾å¤„äºåŒç­‰åœ°ä½ï¼Œé¿å…ç‰¹å¾ä¹‹é—´å·®å¼‚å¤ªå¤§è€Œå½±å“æ¨¡å‹å­¦ä¹ æ•ˆæœã€‚å¸¸ç”¨çš„å¤„ç†æ‰‹æ®µæœ‰ä¸¤ç§ï¼šå½’ä¸€åŒ–å’Œæ ‡å‡†åŒ–ã€‚å½’ä¸€åŒ–æ˜¯å°†åŸæ•°æ®æ˜ å°„åˆ°[m,n]ï¼ˆé€šå¸¸ä¸º[0,1]ï¼‰å†…ï¼Œä½†å½“æ•°æ®å¼‚å¸¸ç‚¹è¾ƒå¤šæ—¶ï¼Œå®¹æ˜“å½±å“å½’ä¸€åŒ–ç»“æœï¼Œé€‚åˆå°æ ·æœ¬ã€‚æ ‡å‡†åŒ–æ˜¯å°†æ•°æ®å˜æ¢ä¸ºå‡å€¼ä¸º0ï¼Œæ ‡å‡†å·®ä¸º1çš„èŒƒå›´å†…ã€‚è€Œå¹³å‡å€¼å’Œæ ‡å‡†å·®å—å¼‚å¸¸å€¼å½±å“è¾ƒå°ï¼Œèƒ½å…‹æœå½’ä¸€åŒ–çš„ç¼ºç‚¹ã€‚æ­¤å¤„ä½¿ç”¨æ ‡å‡†åŒ–è¿›è¡Œä¸¾ä¾‹ã€‚</p><pre class="language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> StandardScaler
scaler <span class="token operator">=</span> StandardScaler<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true">#å› ä¸ºä¸Šå¼è¿”å›ç»“æœä¸ºseriesï¼Œè¿™é‡Œå°†å…¶è½¬æ¢ä¸ºè¡¨æ ¼å½¢å¼ã€‚</span>
df_Standar <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>scaler<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>df<span class="token punctuation">)</span><span class="token punctuation">,</span>index<span class="token operator">=</span>df<span class="token punctuation">.</span>index<span class="token punctuation">,</span> columns<span class="token operator">=</span>df<span class="token punctuation">.</span>columns<span class="token punctuation">)</span>
df_Standar
</code></pre><h1 id="3-ç‰¹å¾é™ç»´"><a href="#3-ç‰¹å¾é™ç»´" class="headerlink" title="3. ç‰¹å¾é™ç»´"></a>3. ç‰¹å¾é™ç»´</h1><p>ç‰¹å¾é™ç»´æŒ‡çš„æ˜¯å¯¹æå–å‡ºæ¥çš„ç‰¹å¾è¿›è¡Œè¿‡æ»¤ç­›é€‰ï¼Œå‡å°‘ç‰¹å¾ç»´åº¦ã€‚ç›®çš„æ˜¯ä¸ºäº†é™ä½å­¦ä¹ ä»»åŠ¡çš„éš¾åº¦å’Œå‡è½»ç»´åº¦ç¾éš¾é—®é¢˜ã€‚<br>é€šå¸¸ï¼Œä»ä¸¤ä¸ªæ–¹é¢è€ƒè™‘æ¥é€‰æ‹©ç‰¹å¾ï¼š</p><ol><li>ç‰¹å¾æ˜¯å¦å‘æ•£<br>å¦‚æœä¸€ä¸ªç‰¹å¾ä¸å‘æ•£ï¼Œä¾‹å¦‚æ–¹å·®æ¥è¿‘äº0ï¼Œä¹Ÿå°±æ˜¯è¯´æ ·æœ¬åœ¨è¿™ä¸ªç‰¹å¾ä¸ŠåŸºæœ¬ä¸Šæ²¡æœ‰å·®å¼‚ï¼Œè¿™ä¸ªç‰¹å¾å¯¹äºæ ·æœ¬çš„åŒºåˆ†å¹¶æ²¡æœ‰ä»€ä¹ˆç”¨ã€‚</li><li>ç‰¹å¾ä¸ç›®æ ‡çš„ç›¸å…³æ€§<br>ä¸ç›®æ ‡ç›¸å…³æ€§é«˜çš„ç‰¹å¾ï¼Œåº”å½“ä¼˜å…ˆé€‰æ‹©ã€‚<br>åŒºåˆ«ï¼šç‰¹å¾ä¸ç‰¹å¾ä¹‹é—´ç›¸å…³æ€§é«˜çš„ï¼Œåº”å½“ä¼˜å…ˆå»é™¤æ‰å…¶ä¸­ä¸€ä¸ªç‰¹å¾ï¼Œå› ä¸ºå®ƒä»¬æ˜¯æ›¿ä»£å“ã€‚<br>ç‰¹å¾é€‰æ‹©æ–¹æ³•æœ‰ï¼šFilterè¿‡æ»¤æ³•ã€WrapperåŒ…è£…æ³•å’ŒEmbeddedåµŒå…¥æ³•ã€‚å…¶ä¸­ç¬¬äºŒä¸‰ç§æ–¹æ³•éƒ½é€‚åˆäºæœ‰ç›‘ç£å­¦ä¹ ï¼Œéœ€è¦ä¸ç›®æ ‡å€¼å…³è”è¿›è¡Œç‰¹å¾é€‰æ‹©ã€‚å› ä¸ºåŸæ•°æ®æ˜¯ä¸ºå¼‚å¸¸æ£€æµ‹ï¼Œæ²¡æœ‰æ ‡ç­¾ï¼Œå±äºæ— ç›‘ç£å­¦ä¹ ï¼Œè¿™é‡Œä»…ä¸¾ä¾‹è¿‡æ»¤æ³•ã€‚<br>é€šè¿‡ç­›é€‰å°æ–¹å·®å’Œå¼ºç›¸å…³ç‰¹å¾æ¥è¾¾åˆ°è¿‡æ»¤ç‰¹å¾çš„ç›®çš„ã€‚<pre class="language-python"><code class="language-python"><span class="token comment" spellcheck="true"># ç‰¹å¾è¿‡æ»¤ filter</span>
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>feature_selection <span class="token keyword">import</span> VarianceThreshold  
X_train_columns <span class="token operator">=</span> df_Standar<span class="token punctuation">.</span>columns
<span class="token comment" spellcheck="true">#æ–¹å·®è¿‡æ»¤ï¼Œè¿”å›æ–¹å·®å¤§äºè®¾å®šé˜ˆå€¼çš„åˆ—</span>
selector <span class="token operator">=</span> VarianceThreshold<span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span>
X <span class="token operator">=</span> selector<span class="token punctuation">.</span>fit_transform<span class="token punctuation">(</span>df_Standar<span class="token punctuation">)</span>
<span class="token comment" spellcheck="true">#å› ä¸ºä¸Šå¼è¿”å›ç»“æœä¸ºseriesï¼Œè¿™é‡Œå°†å…¶è½¬æ¢ä¸ºè¡¨æ ¼å½¢å¼ã€‚</span>
<span class="token comment" spellcheck="true">#X_train_columns[selector.get_support(indices=True)]ç»“æœä¸ºç­›é€‰åçš„åˆ—å</span>
df_filter <span class="token operator">=</span> pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span>X<span class="token punctuation">,</span>index<span class="token operator">=</span>df_concat<span class="token punctuation">.</span>index<span class="token punctuation">,</span> columns<span class="token operator">=</span>X_train_columns<span class="token punctuation">[</span>selector<span class="token punctuation">.</span>get_support<span class="token punctuation">(</span>indices<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
df_filter
</code></pre><pre class="language-python"><code class="language-python"><span class="token comment" spellcheck="true"># ç‰¹å¾è¿‡æ»¤ ç›¸å…³ç³»æ•°corr</span>
<span class="token comment" spellcheck="true"># å‰”é™¤ç›¸å…³æ€§ç³»æ•°é«˜äºthresholdçš„corr_drop</span>
corr_df <span class="token operator">=</span> df_filter<span class="token punctuation">.</span>corr<span class="token punctuation">(</span><span class="token punctuation">)</span>
threshold <span class="token operator">=</span> <span class="token number">0.9</span>
<span class="token comment" spellcheck="true">#k=1,è¿”å›ä¸Šä¸‰è§’çŸ©é˜µ</span>
upper <span class="token operator">=</span> corr_df<span class="token punctuation">.</span>where<span class="token punctuation">(</span>np<span class="token punctuation">.</span>triu<span class="token punctuation">(</span>np<span class="token punctuation">.</span>ones<span class="token punctuation">(</span>corr_df<span class="token punctuation">.</span>shape<span class="token punctuation">)</span><span class="token punctuation">,</span> k<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span>np<span class="token punctuation">.</span>bool<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true">#è¿”å›ç›¸å…³ç³»æ•°å¤§äºé˜ˆå€¼çš„åˆ—å</span>
corr_drop <span class="token operator">=</span> <span class="token punctuation">[</span>column <span class="token keyword">for</span> column <span class="token keyword">in</span> upper<span class="token punctuation">.</span>columns <span class="token keyword">if</span> any<span class="token punctuation">(</span>upper<span class="token punctuation">[</span>column<span class="token punctuation">]</span><span class="token punctuation">.</span>abs<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> threshold<span class="token punctuation">)</span><span class="token punctuation">]</span>
df_filter <span class="token operator">=</span> df_filter<span class="token punctuation">.</span>drop<span class="token punctuation">(</span>corr_drop<span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span>
df_filter
</code></pre><h1 id="4-Tsfreshç‰¹å¾æå–å·¥å…·"><a href="#4-Tsfreshç‰¹å¾æå–å·¥å…·" class="headerlink" title="4. Tsfreshç‰¹å¾æå–å·¥å…·"></a>4. Tsfreshç‰¹å¾æå–å·¥å…·</h1>æœ€åè®²ä¸€ä¸ªç”¨äºæ—¶é—´åºåˆ—ç‰¹å¾æå–çš„å·¥å…·<a class="link" target="_blank" rel="noopener" href="https://tsfresh.readthedocs.io/en/latest/index.html">tsfresh<i class="fas fa-external-link-alt"></i></a><br>å·¥å…·ä»‹ç»å°±ä¸è®²äº†ï¼Œç›´æ¥è¯´ä¸€ä¸‹ç”¨æ³•ã€‚å¯¹äºä¸€æ¡é•¿æ—¶é—´åºåˆ—ï¼Œè¦æƒ³åˆ©ç”¨tsfreshå·¥å…·æå–ç‰¹å¾ï¼Œè¿˜éœ€è¦å…ˆå°†å…¶åŒ–ä¸ºä¸€ä¸ªä¸ªå­çª—å£åºåˆ—ã€‚è¯¥å·¥å…·åŒ…å†…å°±åŒ…å«è¿™ä¸ªåŠŸèƒ½ã€‚åŸè¡¨ç»“æ„ä¸ºï¼š<br><img lazyload="" src="/images/loading.svg" data-src="https://cdn.jsdelivr.net/gh/fight-ing-go/image_repository@master/202204/Characteristic-Engineering-of-Time-Series/%E6%BB%9A%E5%8A%A8%E7%AA%97%E5%8F%A3%E5%8E%9F%E8%A1%A8%E7%BB%93%E6%9E%84.119hmuad0jy8.jpg" alt="æ»šåŠ¨çª—å£åŸè¡¨ç»“æ„"></li></ol><p>å…¶ä¸­id,timeåˆ—æ˜¯åœ¨åŸè¡¨çš„åŸºç¡€ä¸ŠååŠ ä¸Šçš„ï¼Œç›®çš„æ˜¯ä¸ºäº†æ–¹ä¾¿ä½¿ç”¨APIæ¥å£å‡½æ•°ã€‚idä»£è¡¨ç»„åˆ«ï¼Œtimeä»£è¡¨æ—¶é—´é¡ºåºã€‚ç„¶åä½¿ç”¨APIè½¬æ¢ä¸ºçª—å£å­åºåˆ—ã€‚</p><pre class="language-python"><code class="language-python"><span class="token keyword">from</span> tsfresh<span class="token punctuation">.</span>utilities<span class="token punctuation">.</span>dataframe_functions <span class="token keyword">import</span> roll_time_series
<span class="token comment" spellcheck="true"># æ»šåŠ¨çª—å£</span>
<span class="token comment" spellcheck="true">#max_timeshift:æœ€å¤§åç§»é‡ï¼Œmin_timeshiftï¼šæœ€å°åç§»é‡ï¼Œrolling_directionï¼šæ¯æ¬¡ç§»åŠ¨çš„å¤§å°å’Œæ–¹å‘ã€‚column_sortæŒ‰ä»€ä¹ˆæ’åºï¼Œé»˜è®¤å·²ä»å°åˆ°å¤§æ’å¥½</span>
df_rolled <span class="token operator">=</span> roll_time_series<span class="token punctuation">(</span>one_data<span class="token punctuation">,</span> column_id<span class="token operator">=</span><span class="token string">"id"</span><span class="token punctuation">,</span> column_sort<span class="token operator">=</span><span class="token string">"time"</span><span class="token punctuation">,</span>max_timeshift <span class="token operator">=</span> <span class="token number">6</span> <span class="token punctuation">,</span>min_timeshift <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">,</span>rolling_direction<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
df_rolled
</code></pre><p><img lazyload="" src="/images/loading.svg" data-src="https://cdn.jsdelivr.net/gh/fight-ing-go/image_repository@master/202204/Characteristic-Engineering-of-Time-Series/tsfresh%E7%AA%97%E5%8F%A3%E5%BA%8F%E5%88%97.4f2dy005fr40.jpg" alt="tsfreshçª—å£åºåˆ—"><br>è½¬åŒ–åçš„idæ˜¯åŸidä¸åŸæ—¶é—´çš„ç»„åˆï¼Œä¹Ÿä¸ºåé¢ç‰¹å¾æå–ä¸­çš„ç»„åˆ«ã€‚ï¼ˆ1ï¼Œ1ï¼‰ä»£è¡¨1å·ç»„åˆ«çš„ç¬¬ä¸€ä¸ªæ—¶é—´ç‚¹ç»„æˆçš„å­åºåˆ—ï¼Œï¼ˆ1ï¼Œ43316ï¼‰ä»£è¡¨1å·ç»„åˆ«ç¬¬43316ä¸ªç‚¹ç»„æˆçš„å­åºåˆ—ã€‚ç„¶åå†è¿›è¡Œç‰¹å¾æå–.</p><pre class="language-python"><code class="language-python"><span class="token keyword">from</span> tsfresh <span class="token keyword">import</span> extract_features
<span class="token comment" spellcheck="true"># ç‰¹å¾æå–,ä½¿ç”¨dropå…ˆåˆ å»å¤šä½™çš„åˆ—ï¼Œcolumn_idä¸ºç»„åˆ«</span>
df_features <span class="token operator">=</span> extract_features<span class="token punctuation">(</span>df_rolled<span class="token punctuation">.</span>drop<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"date"</span><span class="token punctuation">,</span><span class="token string">"time"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>axis <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> column_id<span class="token operator">=</span><span class="token string">"id"</span><span class="token punctuation">)</span>
df_features
</code></pre><p>ä»¥ä¸Šå³ä¸ºtsfreshç‰¹å¾æå–çš„æ­¥éª¤ï¼Œå…¶å†…ç½®çš„ç‰¹å¾è¿‡æ»¤å‡½æ•°å› éœ€è¦ç›®æ ‡å€¼è€Œä¸é€‚ç”¨æˆ‘çš„æ•°æ®ï¼Œæ‰€ä»¥åç»­ç‰¹å¾é™ç»´ä»ä½¿ç”¨ä¸Šè¿°è¿‡æ»¤æ³•è¿›è¡Œé€‰æ‹©ã€‚</p><blockquote><p>å‚è€ƒç½‘ç«™ï¼š<br><a class="link" target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1536537">ç‰¹å¾å·¥ç¨‹ç³»åˆ—ï¼šæ—¶é—´ç‰¹å¾æ„é€ ä»¥åŠæ—¶é—´åºåˆ—ç‰¹å¾æ„é€ <i class="fas fa-external-link-alt"></i></a><br><a class="link" target="_blank" rel="noopener" href="https://www.heywhale.com/mw/project/5d86eced8499bc002c108cc8">ç‰¹å¾å·¥ç¨‹ç†è®ºä¸ä»£ç å®ç°ç‰¹å¾å·¥ç¨‹ç†è®ºä¸ä»£ç å®ç°<i class="fas fa-external-link-alt"></i></a></p></blockquote></div><div class="post-copyright-info"><div class="article-copyright-info-container"><ul><li>æœ¬æ–‡æ ‡é¢˜ï¼šæ—¶é—´åºåˆ—ç‰¹å¾å·¥ç¨‹</li><li>æœ¬æ–‡ä½œè€…ï¼šEasyBoy</li><li>åˆ›å»ºæ—¶é—´ï¼š2022-04-23 14:50:40</li><li>æœ¬æ–‡é“¾æ¥ï¼šhttps://easyboy-blog.com/characteristic-engineering-of-time-series.html</li><li>ç‰ˆæƒå£°æ˜ï¼šæœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">BY-NC-SA</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</li></ul></div></div><ul class="post-tags-box"><li class="tag-item"><a href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">#æœºå™¨å­¦ä¹ </a>&nbsp;</li><li class="tag-item"><a href="/tags/%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97/">#æ—¶é—´åºåˆ—</a>&nbsp;</li><li class="tag-item"><a href="/tags/%E7%89%B9%E5%BE%81%E5%B7%A5%E7%A8%8B/">#ç‰¹å¾å·¥ç¨‹</a>&nbsp;</li></ul><div class="article-nav"><div class="article-prev"><a class="prev" rel="prev" href="/installing-mariadb-with-bat-in-windows-7-environment.html"><span class="left arrow-icon flex-center"><i class="fas fa-chevron-left"></i> </span><span class="title flex-center"><span class="post-nav-title-item">Windows7ç¯å¢ƒbatå®‰è£…mariadb</span> <span class="post-nav-item">ä¸Šä¸€ç¯‡</span></span></a></div><div class="article-next"><a class="next" rel="next" href="/centos7-an-zhuang-qt-ji-huan-jing-pei-zhi.html"><span class="title flex-center"><span class="post-nav-title-item">centos7å®‰è£…QTåŠç¯å¢ƒé…ç½®</span> <span class="post-nav-item">ä¸‹ä¸€ç¯‡</span> </span><span class="right arrow-icon flex-center"><i class="fas fa-chevron-right"></i></span></a></div></div><div class="comment-container"><div class="comments-container"><div id="comment-anchor"></div><div class="comment-area-title"><i class="fas fa-comments">&nbsp;è¯„è®º</i></div><div class="valine-container"><script data-pjax src="//cdn.jsdelivr.net/npm/valine@latest/dist/Valine.min.js"></script><div id="vcomments"></div><script data-pjax>function loadValine(){function e(e){switch(e){case"en":return"Author";case"zh-CN":return"åšä¸»";default:return"Master"}}new Valine({el:"#vcomments",appId:"TSl5PlExO22wiwkA3e15kGvM-gzGzoHsz",appKey:"36AERjunsq15rL0xcz3ovKbG",meta:["nick","mail","link"],avatar:"wavatar",enableQQ:!0,placeholder:"ğŸ˜œ å°½æƒ…åæ§½å§~",lang:"zh-CN".toLowerCase()});const a=setInterval(()=>{const n=document.querySelectorAll("#vcomments .vcards .vcard");if(n.length>0){let t="EasyBoy";if(t)for(let a of n){const n=a.querySelector(".vhead .vnick"),l=n.innerHTML;l===t&&(n.innerHTML=`${l} <span class="author">${e(KEEP.hexo_config.language)}</span>`)}clearInterval(a)}else clearInterval(a)},2e3)}{const e=setTimeout(()=>{loadValine(),clearTimeout(e)},1e3)}</script></div></div></div></div></div></div></div><div class="page-main-content-bottom"><footer class="footer"><div class="info-container"><div class="copyright-info info-item">&copy; <span>2020</span> - 2022&nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;<a href="/">EasyBoy</a></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div class="website-count info-item"><span id="busuanzi_container_site_uv">è®¿é—®äººæ•°&nbsp;<span id="busuanzi_value_site_uv"></span>&ensp; </span><span id="busuanzi_container_site_pv">æ€»è®¿é—®é‡&nbsp;<span id="busuanzi_value_site_pv"></span></span></div><div class="theme-info info-item">ç”± <a target="_blank" href="https://hexo.io">Hexo</a> é©±åŠ¨&nbsp;|&nbsp;ä¸»é¢˜&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.4.5</a></div></div></footer></div></div><div class="post-tools"><div class="post-tools-container"><ul class="tools-list"><li class="tools-item page-aside-toggle"><i class="fas fa-outdent"></i></li><li class="go-comment"><i class="fas fa-comment"></i></li></ul></div></div><div class="right-bottom-side-tools"><div class="side-tools-container"><ul class="side-tools-list"><li class="tools-item tool-font-adjust-plus flex-center"><i class="fas fa-search-plus"></i></li><li class="tools-item tool-font-adjust-minus flex-center"><i class="fas fa-search-minus"></i></li><li class="tools-item tool-expand-width flex-center"><i class="fas fa-arrows-alt-h"></i></li><li class="tools-item tool-dark-light-toggle flex-center"><i class="fas fa-moon"></i></li><li class="tools-item rss flex-center"><a class="flex-center" href="/atom.xml" target="_blank"><i class="fas fa-rss"></i></a></li><li class="tools-item tool-scroll-to-top flex-center"><i class="fas fa-arrow-up"></i></li><li class="tools-item tool-scroll-to-bottom flex-center"><i class="fas fa-arrow-down"></i></li></ul><ul class="exposed-tools-list"><li class="tools-item tool-toggle-show flex-center"><i class="fas fa-cog fa-spin"></i></li></ul></div></div><aside class="page-aside"><div class="post-toc-wrap"><div class="post-toc"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#1-%E7%89%B9%E5%BE%81%E6%8F%90%E5%8F%96"><span class="nav-text">1. ç‰¹å¾æå–</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-1-%E4%BB%8E%E6%97%B6%E9%97%B4%E4%B8%AD%E6%8F%90%E5%8F%96%E7%89%B9%E5%BE%81"><span class="nav-text">1.1 ä»æ—¶é—´ä¸­æå–ç‰¹å¾</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-2-%E4%BB%8E%E6%97%B6%E5%BA%8F%E8%A7%84%E5%BE%8B%E4%B8%AD%E6%8F%90%E5%8F%96%E7%89%B9%E5%BE%81"><span class="nav-text">1.2 ä»æ—¶åºè§„å¾‹ä¸­æå–ç‰¹å¾</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-3-%E4%BB%8E%E7%BB%9F%E8%AE%A1%E7%AA%97%E5%8F%A3%E6%8F%90%E5%8F%96%E7%89%B9%E5%BE%81"><span class="nav-text">1.3 ä»ç»Ÿè®¡çª—å£æå–ç‰¹å¾</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2-%E7%89%B9%E5%BE%81%E9%A2%84%E5%A4%84%E7%90%86"><span class="nav-text">2. ç‰¹å¾é¢„å¤„ç†</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#3-%E7%89%B9%E5%BE%81%E9%99%8D%E7%BB%B4"><span class="nav-text">3. ç‰¹å¾é™ç»´</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#4-Tsfresh%E7%89%B9%E5%BE%81%E6%8F%90%E5%8F%96%E5%B7%A5%E5%85%B7"><span class="nav-text">4. Tsfreshç‰¹å¾æå–å·¥å…·</span></a></li></ol></div></div></aside><div class="image-viewer-container"><img src=""></div><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-input-field-pre"><i class="fas fa-keyboard"></i></span><div class="search-input-container"><input autocomplete="off" autocorrect="off" autocapitalize="off" placeholder="æœç´¢..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fas fa-times"></i></span></div><div id="search-result"><div id="no-result"><i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div></main><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/utils.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/main.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/header-shrink.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/back2top.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/dark-light-toggle.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/local-search.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/code-copy.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/lazyload.js"></script><div class="post-scripts pjax"><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/left-side-toggle.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/libs/anime.min.js"></script><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/toc.js"></script></div><script src="//cdn.jsdelivr.net/npm/hexo-theme-keep@3.4.5/source/js/libs/pjax.min.js"></script><script>window.addEventListener("DOMContentLoaded",()=>{window.pjax=new Pjax({selectors:["head title",".page-container",".pjax"],history:!0,debug:!1,cacheBust:!1,timeout:0,analytics:!1,currentUrlFullReload:!1,scrollRestoration:!1}),document.addEventListener("pjax:send",()=>{KEEP.utils.pjaxProgressBarStart()}),document.addEventListener("pjax:complete",()=>{KEEP.utils.pjaxProgressBarEnd(),window.pjax.executeScripts(document.querySelectorAll("script[data-pjax], .pjax script")),KEEP.refresh()})})</script></body></html>